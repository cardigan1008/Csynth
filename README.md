# Csynth
A tool for profiling C program and then synthesizing mutants based on the profiled program.
This is a part of our LLM-based compiler testing tool.

This project is based on [Creal](https://github.com/UniCodeSphere/Creal). However, in this tool, 
we **get rid of Csmith** to synthesize programs by only using the programs in the source database.

## Usage

**Step 0: Install the dependencies**

- Python >= 3.10
- CompCert (refer to [CompCert](https://compcert.org/man/manual002.html#install))
- clang >= 14, libclang-dev
- diopter == 0.0.24 (`pip install diopter==0.0.24`)
- termcolor (`pip install termcolor`)


**Step 1: Compile the profiler**

```shell
$ cd profiler
$ mkdir build
$ cd build
$ cmake ..
$ make
```

**Step2: Profile the program**

This step will add profile information and replace code with the profiled one to functions in the source database and save the result to the destination database.

Note: The source database should be generated by [databaseconstructor in Creal](https://github.com/UniCodeSphere/Creal/tree/main/databaseconstructor). 

```shell
$ python3 profiler.py --src <source database> --dst <destination database>
```

**Step3: Synthesize the profiled program**

This step will produce synthesized programs with the programs in the source database and 
store the mutants in the destination directory.

Note: The source database should be profiled by the profiler, which is `destination database` in the previous step. 

```shell
$ python3 synthesizer.py --dst <destination dir> --db <source database>
```

## TODO

- [x] Rename tags before synthesizing mutants

- [x] Integrate with the LLM-based compiler testing tool
